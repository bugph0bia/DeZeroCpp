# DeZeroCpp
ゼロから作るDeep Learning ❸ をC++で実装する。

## 概要
「[ゼロから作るDeep Learning ❸](https://www.oreilly.co.jp/books/9784873119069/)」を参考にしながら、ディープラーニング用フレームワーク DeZero を C++ で実装しながら学習する。  

## はじめに
目的は、「ゼロから作るDeep Learning ❸」を再読しながら理解を深めることと、C++ の復習。  

### 環境構成
DeZero で使用している Python 用のライブラリや外部ツールの全てを C++ で用意することは難しいかもしれないが、取り合えず以下の構成で始めてみる。  
Windows 上で Visual Studio 2017 以降を使用する。  

| DeZero     | DeZeroCpp                                                                                       |
|------------|-------------------------------------------------------------------------------------------------|
| Python 3   | C++                                                                                             |
| NumPy      | [NumCpp](https://github.com/dpilger26/NumCpp) (v2.00) + [boost](https://www.boost.org/) (v1.73) |
| Matplotlib | 未定。                                                                                          |
| CuPy       | 未定。多分 GUI 対応は不可能。                                                                   |
| Pillow     | 未定                                                                                            |
| Graphviz   | Graphviz                                                                                        |

- NumCpp には boost も必要。ただし、libファイルは不要なのでダウンロードしてらビルドせずに配置するだけで良い。
    - プロジェクトのプロパティで、「追加のインクルードディレクトリ」に 2 つのライブラリのパスを追加しておく。
- Graphviz はテキストインタフェースのツールなのでそのまま使える。

### 方針
- 気づいた点はなるべく細かくメモする。復習が目的なので。

## 開発記録
### ステップ 1：箱としての変数
- Variable クラス
    - `__init__` は C++ ではコンストラクタになる。初期化代入子を使ってメンバを初期化。
    - 今後、継承することになるため、仮想デストラクタを用意しておく。
- NumCpp
    - NumPy は n 次元のテンソルを扱えるが、NumCpp は 2 次元の行列固定。3 次元以上のテンソルが CNN のあたりで出てくるが、まだまだ先のことだし、NumPy ライクに使える他のライブラリが見つからないので、このまま進める。
    - スカラーやベクトルも 2 次元で保持されてしまうようなので、適宜変換が必要かもしれない。
    - NumCpp の warning C4819 (文字コード関係) が 3 つ出るが、とりあえず保留にして進む。
- その他
    - 命名規則は C++ の標準的なスタイルに従う。メンバ変数のスタイルは色々あるようだけど、特に接頭辞や接尾辞は付けないスタイルとする。
    - 名前空間は `dz` としてまとめる。
    - よく使う型は using でエイリアスを作っておく。

### ステップ 2：変数を生み出す関数
- Function クラス
    - オーバーライド必須の関数は、Python では `NoImplementedError` 例外を投げているが、C++ では純粋仮想関数とした。
- step02
    - Python の `type(y)` は、C++ では `typeid(y).name()` に置き換えた。
- その他
    - 書籍のステップに合わせて、stepXX という関数を作りながら進めることにする。その関数を main から呼び出すことにする。
        - Python だと実行するスクリプトを step01.py, step02.py, ... のように変えながら進めるのが簡単だが、Visual Studio 上の C++ で開発していると、main 関数をひとつに固定しておかないと面倒なので。
    - あと、同じ名前のクラスがプロジェクト内に複数存在するとリンクエラーになってしまうので、とりあえず step.hpp というヘッダに押し込めて共有することにした。
        - この先、別のヘッダにクラスを移すときには削除しなければならないかも。コンパイルエラーになるようなケースでは、古いコードは消していくしかない。

